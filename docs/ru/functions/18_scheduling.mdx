---
weight: 18
sourceSHA: 2e7982c202aca0aac8666584e0e52fdf190aee0de3f0eff54815996030e735fc
---

# Конфигурация планирования

Политика планирования позволяет экземплярам запускаться на определенных узлах и эффективно предотвращает назначение других приложений на эти узлы, обеспечивая высокую доступность экземпляров.

## Обзор сценария

- PostgreSQL развернут в выделенном бизнес-кластере, и клиенты хотят, чтобы разные экземпляры PostgreSQL работали на разных узлах для облегчения обслуживания и быстрой локализации неисправностей.

- PostgreSQL развернут в существующем бизнес-кластере, и клиенты хотят развернуть экземпляры PostgreSQL на определенных узлах, предотвращая назначение других приложений на те же узлы.

Оба сценария могут быть реализованы путем настройки **меток узлов** и **допусков подов** в разделе **Конфигурация планирования** на странице создания экземпляра.

Этот раздел демонстрирует, как запустить экземпляры PostgreSQL на разных указанных узлах. Назначенные узлы следующие:

| Компонент       | Указанные узлы                                   |
| --------------- | ------------------------------------------------ |
| **PostgreSQL**  | 192.168.100.103 192.168.100.104 192.168.100.105 |

## Предварительные условия

1. Администратор платформы должен **обновить метки узлов** на указанных узлах, чтобы промежуточное программное обеспечение могло назначаться на назначенные узлы на основе меток.

2. Администратор платформы должен **установить загрязнения** на указанных узлах, чтобы обеспечить возможность назначения промежуточного программного обеспечения на загрязненные узлы на основе допуска, предотвращая назначение других приложений на эти узлы.

Вы можете настроить узлы и загрязнения в соответствии с реальными требованиями.

Администратор платформы уже настроил загрязнения и метки узлов в центре платформы со следующими конфигурациями:

| Узел                                           | Метка узла                  | Загрязнение узла                      |
| ---------------------------------------------- | --------------------------- | ------------------------------------- |
| **192.168.100.103 192.168.100.104 192.168.100.105** | keypostgres=valuepostgres  | keypostgres=valuepostgres:NoSchedule |

## Объяснение конфигурации

- **Загрязнение**: Атрибут в формате ключ-значение на узле, который предотвращает назначение подов на него, если у пода нет соответствующего допуска.

- **Допуск**: Атрибут в формате ключ-значение на поде, который позволяет ему переносить конкретные загрязнения узла, обеспечивая назначение пода только на узлы, которые он может терпеть.

Загрязнения и допуска поддерживают параметр `effect`, с синтаксическим форматом `key=value:effect`. `Effect` определяет уровень исключения для пода и включает три типа:

| Тип эффекта         | Описание                                                                                                                                                                                                               |
| ------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **NoSchedule**      | Новые поды, которые не могут переносить это загрязнение, не могут быть назначены на узел. Это строгое ограничение, но существующие поды на узле остаются неизменными.                                                 |
| **PreferNoSchedule**| Более мягкая версия NoSchedule, при которой новые поды, не переносящие это загрязнение, предпочтительно не должны назначаться на узел, но они все еще могут быть назначены туда, если нет других доступных узлов. Существующие поды остаются неизменными. |
| **NoExecute**       | Новые поды, которые не могут переносить это загрязнение, не могут быть назначены на узел. Кроме того, если существующий под больше не соответствует критериям загрязнения-допуска из-за изменений в загрязнении узла или допуска пода, он будет выселен. |

При определении допусков на поде поддерживаются два оператора:

| Оператор    | Описание                                                                                  |
| ----------- | ---------------------------------------------------------------------------------------- |
| **Equal**   | Допуск пода должен точно соответствовать ключу, значению и эффекту загрязнения узла.    |
| **Exists**  | Допуск пода должен соответствовать ключу и эффекту загрязнения узла, но поле значения может быть пустым. |

## Процедура

<Tabs>
  <Tab label="Веб-консоль">
    1. В левой панели навигации нажмите **PostgreSQL**.

    2. Нажмите **Создать экземпляр PostgreSQL**.

    3. Завершите конфигурацию параметров. В разделе **Конфигурация планирования** выберите метку узла и загрязнение на основе указанных узлов.

    4. Нажмите **Создать**. Под PostgreSQL будет назначен на узлы 192.168.100.103, 192.168.100.104 и 192.168.100.105.
  </Tab>
</Tabs>

## Проверка

Вы можете проверить, что экземпляры PostgreSQL работают на указанных узлах, перейдя в **Платформа контейнеров** > **Вычеслительные компоненты** > **Группы контейнеров**.
