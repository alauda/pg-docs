---
weight: 40
---

# 监控体系

## 架构概述

PostgreSQL Operator 监控体系包含以下组件：

1. **Prometheus**：指标收集和存储
2. **Grafana**：数据可视化
3. **Alertmanager**：告警管理
4. **Postgres Exporter**：采集 PostgreSQL 指标

## 关键指标

| 指标 | 说明 |
|------|------|
| pg_stat_activity | 当前活动连接 |
| pg_stat_database | 数据库统计信息 |
| pg_stat_user_tables | 用户表统计 |
| pg_stat_bgwriter | 后台写入统计 |
| pg_stat_replication | 复制状态 |

## 告警规则

1. **连接数过高**：active_connections > max_connections * 0.8
2. **复制延迟**：replication_lag > 1048576 bytes
3. **缓存命中率低**：cache_hit_ratio < 0.95
4. **磁盘空间不足**：disk_usage > 80%

## 最佳实践

1. 配置合理的告警阈值
2. 定期审查监控指标
3. 优化慢查询
4. 监控资源使用情况
